





var trello;

trello = angular.module('trello', []);

trello.factory('listsFactory', function() {
  var id, lists, service;
  service = {};
  id = 4;
  lists = [
    {
      id: 1,
      title: 'ToDo'
    }, {
      id: 2,
      title: 'Doing'
    }, {
      id: 3,
      title: 'Done'
    }
  ];
  service.getLists = function() {
    return lists;
  };
  service.addList = function(title) {
    if (title == null) {
      return;
    }
    return lists.push({
      id: id++,
      title: title
    });
  };
  service.removeList = function(id) {
    return lists.splice(id, 1);
  };
  return service;
});

trello.factory('cardsFactory', function() {
  var cards, id, service;
  service = {};
  id = 4;
  cards = [
    {
      id: 1,
      title: 'Learn CoffeeScript',
      list_id: 1
    }, {
      id: 2,
      title: 'Learning AngularJs',
      list_id: 2
    }, {
      id: 3,
      title: 'Learn Wordpress',
      list_id: 3
    }
  ];
  service.getCards = function() {
    return cards;
  };
  service.addCard = function(title, list_id) {
    if (title == null) {
      return;
    }
    return cards.push({
      id: id++,
      title: title,
      list_id: list_id
    });
  };
  service.removeCard = function(card_id) {
    var i, _i, _ref;
    for (i = _i = 0, _ref = cards.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
      if (cards[i].id === card_id) {
        return cards.splice(i, 1);
      }
    }
  };
  return service;
});

trello.controller('listCtrl', [
  '$scope', 'listsFactory', 'cardsFactory', function($scope, listsFactory, cardsFactory) {
    $scope.removeList = function(index) {
      return listsFactory.removeList(index);
    };
    $scope.cards = cardsFactory.getCards();
    return $scope.addCard = function(list_id) {
      cardsFactory.addCard($scope.cardTitle, list_id);
      $scope.cardTitle = null;
    };
  }
]);

trello.controller('listsCtrl', [
  '$scope', 'listsFactory', 'cardsFactory', function($scope, listsFactory, cardsFactory) {
    $scope.lists = listsFactory.getLists();
    return $scope.addList = function() {
      listsFactory.addList($scope.listTitle);
      $scope.listTitle = null;
    };
  }
]);

trello.controller('cardCtrl', [
  '$scope', 'listsFactory', 'cardsFactory', function($scope, listsFactory, cardsFactory) {
    $scope.removeCard = function(card_id) {
      return cardsFactory.removeCard(card_id);
    };
    $scope.editCard = function() {
      $scope.cardEditing = true;
      return $scope.cardTitleCopy = $scope.card.title;
    };
    $scope.updateCard = function() {
      if ($scope.card.title === "") {
        return;
      }
      return $scope.cardEditing = false;
    };
    return $scope.escCardEdit = function(e) {
      if (e.keyCode === 27) {
        $scope.card.title = $scope.cardTitleCopy;
        return $scope.cardEditing = false;
      }
    };
  }
]);
